---
title: "pkgsimil"
output:
  md_document:
    variant: gfm

  rmarkdown::html_vignette:
    self_contained: no
---

<!-- badges: start -->

[![R build
status](https://github.com/ropensci-review-tools/pkgsimil/workflows/R-CMD-check/badge.svg)](https://github.com/ropensci-review-tools/pkgsimil/actions?query=workflow%3AR-CMD-check)
[![codecov](https://codecov.io/gh/ropensci-review-tools/pkgsimil/branch/main/graph/badge.svg)](https://app.codecov.io/gh/ropensci-review-tools/pkgsimil)
[![Project Status:
Active](https://www.repostatus.org/badges/latest/active.svg)](https://www.repostatus.org/#active)
<!-- badges: end -->

# pkgsimil

Similarity metrics between R packages, functions, or any code, based on
similarity of code, documentation, or both. Currently implements the following
metrics:

- `tree_similarity()` to measure similarity of syntax trees.

To start, the package needs to be loaded:

```{r load}
library (pkgsimil)
```




## Tree Similarity

The `tree_similarity()` function requires syntax trees as its main parameters.
These can be generated by the `tree_get()` function. This function accepts a
character vector of package names, and returns a syntax tree for each package
in [S-expression form](https://en.wikipedia.org/wiki/S-expression), with each
tree represented by a single character string. The following code extracts
trees for two similar packages, [`pkgload`](https://pkgload.r-lib.org) and
[`pkgbuild`](https://pkgbuild.r-lib.org), with an obviously different package,
[`geodist`](https://hypertidy.github.io/geodist).


```{r trees}
pkgs <- c ("pkgload", "pkgbuild", "geodist")
trees <- tree_get (pkgs, exported_only = TRUE)
sapply (trees, nchar)
substring (trees [1], 1, 80)
```

Note that that code used `exported_only = TRUE` to only return trees
corresponding to the exported functions of the packages. This generally returns
notably smaller trees, and so speeds up the following comparisons. The default
value of `FALSE` for that parameter should generally be used, so that packages
are compared in their entirety, although that will generally take notably
longer to calculate.

The trees can then be compared with the `tree_similarity()` function:

```{r tree-simil}
system.time (
    res <- tree_similarity (trees)
)
print (res)
```

And as expected, the `pkgload` and `pkgbuild` packages are more similar to one
another than either is to `geodist`.
